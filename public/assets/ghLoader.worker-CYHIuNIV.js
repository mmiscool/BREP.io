var T=Object.defineProperty;var i=(w,y)=>T(w,"name",{value:y,configurable:!0});(function(){"use strict";const w="raw.githubusercontent.com";function y(n){try{return new URL(n).hostname===w}catch{return!1}}i(y,"isRawUrl");function k(n){try{return new URL(".",n).href}catch{return n}}i(k,"dirOf");function $(n){try{const e=new URL(n);return e.search="",e.hash="",e.href}catch{return n}}i($,"normalize");function B(n){const e=[],l=/\b(?:import|export)\s+(?:[^'";]*?\sfrom\s+)?(["'])([^"']+)(\1)/g,u=/\bimport\s*\(\s*(["'])([^"']+)(\1)\s*\)/g;let o;for(;o=l.exec(n);){const c=o[1],f=o[2];e.push({kind:"static",q:c,spec:f})}for(;o=u.exec(n);){const c=o[1],f=o[2];e.push({kind:"dynamic",q:c,spec:f})}return e}i(B,"findSpecifiers");async function x(n){const e=await fetch(n,{mode:"cors",credentials:"omit"});if(!e||!e.ok)throw new Error(`HTTP ${e&&e.status}`);return e.text()}i(x,"fetchText");async function M(n){const e=new Map,l=new Map,u=new Set;async function o(d){const a=$(d);if(e.has(a))return e.get(a);if(u.has(a)){const s=URL.createObjectURL(new Blob(["export {};"],{type:"application/javascript"}));return e.set(a,s),s}u.add(a);const L=await x(d),g=k(d),S=B(L).filter(s=>s&&typeof s.spec=="string"),U=[];for(const s of S){const t=s.spec.trim();if(!t)continue;const r=t.startsWith(".")||t.startsWith(".."),h=t.startsWith("http://")||t.startsWith("https://")?y(t):!1;if(!r&&!h)continue;const b=r?new URL(t,g).href:t;U.push({lit:t,abs:b})}const R=new Map;for(const s of U){const t=$(s.abs);R.has(t)||R.set(t,s)}const m=new Map;for(const[s,t]of R.entries()){const r=await o(t.abs);m.set(t.lit,r)}let p=L;p=p.replace(/\b(?:import|export)\s+(?:[^'";]*?\sfrom\s+)?(["'])([^"']+)(\1)/g,(s,t,r)=>{const h=m.get(r);if(h)return s.replace(`${t}${r}${t}`,`${t}${h}${t}`);if(r.startsWith(".")||r.startsWith(".."))try{const b=new URL(r,g).href;return s.replace(`${t}${r}${t}`,`${t}${b}${t}`)}catch{}return s}),p=p.replace(/\bimport\s*\(\s*(["'])([^"']+)(\1)\s*\)/g,(s,t,r)=>{const h=m.get(r);if(h)return s.replace(`${t}${r}${t}`,`${t}${h}${t}`);if(r.startsWith(".")||r.startsWith(".."))try{const b=new URL(r,g).href;return s.replace(`${t}${r}${t}`,`${t}${b}${t}`)}catch{}return s});const W=URL.createObjectURL(new Blob([p],{type:"application/javascript"}));return e.set(a,W),l.set(a,p),u.delete(a),W}i(o,"loadModule");const c=await o(n);return{code:l.get($(n))||"",entryBlob:c}}i(M,"buildGraph"),self.addEventListener("message",async n=>{const e=n.data||{};if(e.type!=="load")return;const l=Array.isArray(e.urls)?e.urls:[],u=Array.isArray(e.bases)?e.bases:[];let o=null;for(let c=0;c<l.length;c++){const f=l[c],d=u[c]||"";try{const{code:a}=await M(f);self.postMessage({ok:!0,code:a,usedUrl:f,usedBase:d});return}catch(a){o=a}}self.postMessage({ok:!1,error:String(o||"Failed to load plugin")})})})();
